      - name: Restore backend
        shell: bash
        run: |
          set -euo pipefail

          if [ "${{ steps.sln.outputs.found }}" = "true" ]; then
            echo "Trying restore with solution"
            if dotnet restore "${{ steps.sln.outputs.path }}"; then
              exit 0
            fi
            echo "Solution restore failed, fallback to csproj"
          fi

          dotnet restore $(find src -name '*.csproj')

      - name: Build backend
        shell: bash
        run: |
          set -euo pipefail

          if [ "${{ steps.sln.outputs.found }}" = "true" ]; then
            echo "Trying build with solution"
            if dotnet build "${{ steps.sln.outputs.path }}" -c Release --no-restore; then
              exit 0
            fi
            echo "Solution build failed, fallback to csproj"
          fi

          dotnet build $(find src -name '*.csproj') -c Release --no-restore
